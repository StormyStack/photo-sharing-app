files:
  "/etc/systemd/system/gunicorn.service":
    mode: "000644"
    owner: root
    group: root
    content: |
      [Unit]
      Description=Gunicorn instance to serve Flask app
      After=network.target

      [Service]
      User=ec2-user
      Group=ec2-user
      WorkingDirectory=/var/app/current
      Environment="PATH=/var/app/current/venv/bin"
      ExecStart=/var/app/current/venv/bin/gunicorn -w 4 -b 127.0.0.1:8000 app:app

      [Install]
      WantedBy=multi-user.target
